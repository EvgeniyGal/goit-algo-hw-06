import networkx as nx
from collections import deque


def create_base_graph():
    """–°—Ç–≤–æ—Ä—é—î –≥—Ä–∞—Ñ –¥–ª—è –ø–æ—à—É–∫—É —à–ª—è—Ö—ñ–≤."""
    G = nx.Graph()
    G.add_nodes_from(
        [
            "–¶–µ–Ω—Ç—Ä",
            "–í–æ–∫–∑–∞–ª",
            "–ü–∞—Ä–∫",
            "–†–∏–Ω–∫–æ–≤–∞ –ü–ª–æ—â–∞",
            "–£–Ω—ñ–≤–µ—Ä—Å–∏—Ç–µ—Ç",
            "–ë—ñ–±–ª—ñ–æ—Ç–µ–∫–∞",
            "–ñ–∏—Ç–ª–æ–≤–∏–π –ú–∞—Å–∏–≤",
        ]
    )
    G.add_edges_from(
        [
            ("–¶–µ–Ω—Ç—Ä", "–í–æ–∫–∑–∞–ª"),
            ("–¶–µ–Ω—Ç—Ä", "–ü–∞—Ä–∫"),
            ("–¶–µ–Ω—Ç—Ä", "–†–∏–Ω–∫–æ–≤–∞ –ü–ª–æ—â–∞"),
            ("–í–æ–∫–∑–∞–ª", "–ñ–∏—Ç–ª–æ–≤–∏–π –ú–∞—Å–∏–≤"),
            ("–ü–∞—Ä–∫", "–ë—ñ–±–ª—ñ–æ—Ç–µ–∫–∞"),
            ("–†–∏–Ω–∫–æ–≤–∞ –ü–ª–æ—â–∞", "–£–Ω—ñ–≤–µ—Ä—Å–∏—Ç–µ—Ç"),
            ("–£–Ω—ñ–≤–µ—Ä—Å–∏—Ç–µ—Ç", "–ë—ñ–±–ª—ñ–æ—Ç–µ–∫–∞"),
            ("–ë—ñ–±–ª—ñ–æ—Ç–µ–∫–∞", "–ñ–∏—Ç–ª–æ–≤–∏–π –ú–∞—Å–∏–≤"),
            ("–†–∏–Ω–∫–æ–≤–∞ –ü–ª–æ—â–∞", "–ñ–∏—Ç–ª–æ–≤–∏–π –ú–∞—Å–∏–≤"),
        ]
    )
    return G


# --- –í–ª–∞—Å–Ω–∞ –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è BFS (–ü–æ—à—É–∫ —É –®–∏—Ä–∏–Ω—É) ---
def custom_bfs(graph, start, end):
    """–ó–Ω–∞—Ö–æ–¥–∏—Ç—å –Ω–∞–π–∫–æ—Ä–æ—Ç—à–∏–π —à–ª—è—Ö –∑–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—é —Ä–µ–±–µ—Ä, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —á–µ—Ä–≥—É."""
    # –ß–µ—Ä–≥–∞ –¥–ª—è –æ–±—Ö–æ–¥—É
    queue = deque([[start]])
    # –ú–Ω–æ–∂–∏–Ω–∞ –¥–ª—è –≤—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è –≤—ñ–¥–≤—ñ–¥–∞–Ω–∏—Ö –≤–µ—Ä—à–∏–Ω
    visited = {start}

    while queue:
        # –í–∏–ª—É—á–∞—î–º–æ –ø–µ—Ä—à–∏–π —à–ª—è—Ö
        path = queue.popleft()
        node = path[-1]

        # –Ø–∫—â–æ –∑–Ω–∞–π–¥–µ–Ω–æ —Ü—ñ–ª—å–æ–≤—É –≤–µ—Ä—à–∏–Ω—É
        if node == end:
            return path

        # –î–æ–¥–∞—î–º–æ —Å—É—Å—ñ–¥—ñ–≤ –¥–æ —á–µ—Ä–≥–∏
        for neighbor in graph.neighbors(node):
            if neighbor not in visited:
                visited.add(neighbor)
                new_path = path + [neighbor]
                queue.append(new_path)
    return None


# --- –í–ª–∞—Å–Ω–∞ –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è DFS (–ü–æ—à—É–∫ —É –ì–ª–∏–±–∏–Ω—É) ---
def custom_dfs(graph, start, end):
    """–ó–Ω–∞—Ö–æ–¥–∏—Ç—å –æ–¥–∏–Ω —à–ª—è—Ö, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —Å—Ç–µ–∫ (—Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ –∞–±–æ —ñ—Ç–µ—Ä–∞—Ç–∏–≤–Ω–æ).
    –¢—É—Ç –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ —ñ—Ç–µ—Ä–∞—Ç–∏–≤–Ω–∏–π –ø—ñ–¥—Ö—ñ–¥ –∑—ñ —Å—Ç–µ–∫–æ–º.
    """
    # –°—Ç–µ–∫ –¥–ª—è –æ–±—Ö–æ–¥—É. –ó–±–µ—Ä—ñ–≥–∞—î–º–æ (–≤–µ—Ä—à–∏–Ω–∞, —à–ª—è—Ö_–¥–æ_–Ω–µ—ó)
    stack = [(start, [start])]
    visited = {start}

    while stack:
        # –í–∏–ª—É—á–∞—î–º–æ –æ—Å—Ç–∞–Ω–Ω—ñ–π –µ–ª–µ–º–µ–Ω—Ç (LIFO)
        node, path = stack.pop()

        if node == end:
            return path

        # –û–±—Ö—ñ–¥ —Å—É—Å—ñ–¥—ñ–≤ —É –∑–≤–æ—Ä–æ—Ç–Ω–æ–º—É –ø–æ—Ä—è–¥–∫—É, —â–æ–± —ñ–º—ñ—Ç—É–≤–∞—Ç–∏ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–∏–π DFS
        # (–ó–∞–±–µ–∑–ø–µ—á—É—î —Ç–∞–∫–∏–π —Å–∞–º–∏–π –ø–æ—Ä—è–¥–æ–∫, —è–∫ —É –ø–µ—Ä—à–æ–º—É –∑–∞–≤–¥–∞–Ω–Ω—ñ: –¶–µ–Ω—Ç—Ä -> –í–æ–∫–∑–∞–ª)
        for neighbor in reversed(list(graph.neighbors(node))):
            if neighbor not in visited:
                visited.add(neighbor)
                new_path = path + [neighbor]
                stack.append((neighbor, new_path))
    return None


def task_2_dfs_bfs_search():
    """–í–∏–∫–æ–Ω—É—î –ø–æ—à—É–∫ —à–ª—è—Ö—ñ–≤ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –≤–ª–∞—Å–Ω–æ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–∏—Ö DFS —Ç–∞ BFS."""
    G = create_base_graph()
    print("\n--- üîç –ó–ê–í–î–ê–ù–ù–Ø 2: –í–ª–∞—Å–Ω–∞ –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è BFS —Ç–∞ DFS ---")

    start_node = "–¶–µ–Ω—Ç—Ä"
    end_node = "–ñ–∏—Ç–ª–æ–≤–∏–π –ú–∞—Å–∏–≤"

    # 1. –í–ª–∞—Å–Ω–∞ –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è BFS
    bfs_path = custom_bfs(G, start_node, end_node)
    bfs_length = len(bfs_path) - 1 if bfs_path else 0

    print(f"1. –®–ª—è—Ö BFS (–≤–ª–∞—Å–Ω–∞ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è) –≤—ñ–¥ {start_node} –¥–æ {end_node}:")
    print(f"   - –®–ª—è—Ö: {bfs_path}")
    print(f"   - –î–æ–≤–∂–∏–Ω–∞ (–∫—ñ–ª—å–∫—ñ—Å—Ç—å —Ä–µ–±–µ—Ä): {bfs_length}")

    # 2. –í–ª–∞—Å–Ω–∞ –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è DFS
    dfs_path = custom_dfs(G, start_node, end_node)
    dfs_length = len(dfs_path) - 1 if dfs_path else 0

    print(f"\n2. –®–ª—è—Ö DFS (–≤–ª–∞—Å–Ω–∞ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è) –≤—ñ–¥ {start_node} –¥–æ {end_node}:")
    print(f"   - –®–ª—è—Ö: {dfs_path}")
    print(f"   - –î–æ–≤–∂–∏–Ω–∞ (–∫—ñ–ª—å–∫—ñ—Å—Ç—å —Ä–µ–±–µ—Ä): {dfs_length}")


if __name__ == "__main__":
    task_2_dfs_bfs_search()
